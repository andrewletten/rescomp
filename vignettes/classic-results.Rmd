---
title: "Classic results with rescomp"
output: rmarkdown::html_document
vignette: >
  %\VignetteIndexEntry{classic-results}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

This vignette reproduces classic results from the literature with `rescomp`.

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(rescomp)
```

### Armstrong and McGehee (1980) Competitive Exclusion. *The American Naturalist*.

```{r}
pars <- spec_rescomp(
  spnum = 2, 
  resnum = 1,
  funcresp = c("type2", "type1"),
  mumatrix = list(matrix(c(0.5, 0.003), 
                    nrow = 2, 
                    ncol = 1,
                    byrow = TRUE)),
  kmatrix = matrix(c(50, 1), 
                   nrow = 2, 
                   ncol = 1, 
                   byrow = TRUE),  
  effmatrix = matrix(c(0.3, 0.33), 
                   nrow = 2, 
                   ncol = 1, 
                   byrow = TRUE),  
  mort = c(0.1, 0.11),
  chemo = FALSE,
  resspeed = 0.1,
  resconc = 300,
  totaltime = 600,
  cinit = c(1,0.01),
  rinit = 400,
  introseq = c(0,194)
)
```


```{r, fig.width = 4, fig.height = 3}
plot_funcresp(pars, maxx = 200, madj = TRUE)
```

```{r}
m1 <- sim_rescomp(pars)
```

```{r, fig.width = 6, fig.height = 3}
plot_rescomp(m1)
```



### Huisman and Weissing (1999) [Biodiversity of plankton by species oscillations and chaos](https://www.nature.com/articles/46540). *Nature*, 402, 407â€“410


```{r}
pars <- spec_rescomp(
  spnum = 6, 
  resnum = 3,
  funcresp = "type2",
  mumatrix = list(matrix(c(1, 1, 1, 
                           1, 1, 1, 
                           1, 1, 1, 
                           1, 1, 1, 
                           1, 1, 1,
                           1, 1, 1), 
                         nrow = 6, 
                         ncol = 3,
                         byrow = TRUE)),
  kmatrix = matrix(c(1.00, 0.30, 0.90,
                     0.90, 1.00, 0.30,
                     0.30, 0.90, 1.00,
                     1.04, 0.71, 0.46,
                     0.34, 1.02, 0.34,
                     0.77, 0.76, 1.07), 
                   nrow = 6, 
                   ncol = 3,
                   byrow = TRUE),
  qmatrix = matrix(c(0.04, 0.08, 0.14,
                     0.07, 0.08, 0.10,
                     0.04, 0.10, 0.10,
                     0.10, 0.10, 0.16,
                     0.03, 0.05, 0.06,
                     0.02, 0.17, 0.14), 
                   nrow = 6, 
                   ncol = 3,
                   byrow = TRUE),
  resspeed = 0.25,
  resconc = c(6, 10, 14),
  mort = 0.25,
  cinit = c(0.1 + 1/100, 0.1 + 2/100, 0.1 + 3/100, 0.1, 0.1, 0.1),
  essential = TRUE,
  totaltime = 15000, 
  introseq = c(0, 0, 0, 1000, 2000, 5000)
)
```
```{r}
plot_funcresp(pars)
```



```{r, cache = TRUE}
m1 <- sim_rescomp(pars)
```

```{r, fig.cap = "Reproduces Fig 1c from Huisman and Weissing (1999)."}
plot_rescomp(m1, resources = FALSE)
```

#### Grover (1990) Resource Competition in a Variable Environment: Phytoplankton Growing According to Monod's Model. *The American Naturalist*.


```{r}
pars <- spec_rescomp(
  spnum = 2, 
  resnum = 1,
  funcresp = "type2",
  mumatrix = list(matrix(c(0.5, 
                           0.6), 
                   nrow = 2, 
                   ncol = 1,
                   byrow = TRUE)),
  kmatrix = matrix(c(0.000001, 
                     0.00001), 
                   nrow = 2, 
                   ncol = 1,
                   byrow = TRUE),
  qmatrix = matrix(c(1/10^8,
                     1/10^8), 
                   nrow = 2, 
                   ncol = 1,
                   byrow = TRUE),
  resspeed = 0.25,
  resconc = 0.0002,
  mort = 0.25,
  cinit = 1000,
  totaltime = 100, 
)
```

```{r, fig.cap = "Reproduces Fig 1 from Grover (1990). Resource concentration in $mu$mol per ml rather than  per L."}
plot_funcresp(pars, maxx = 0.0001)
```

```{r}
mcons <- sim_rescomp(pars)
```


```{r, warning = FALSE, fig.cap = "Reproduces Fig 4A from Grover (1990)."}
plot_rescomp(mcons, resources = FALSE, logy = TRUE)
```


```{r}
period <- 1
amp <- ((0.0002*0.25*period)/(1 - exp(-0.25*period)) - 0.0002)*2
pars$respulse <- amp
pars$resconc <- 0
pars$rinit <- amp
pars$pulsefreq <- period
pars
```

```{r, fig.cap = "Reproduces Fig 4B from Grover (1990)."}
m1 <- sim_rescomp(pars)
plot_rescomp(m1, resource = FALSE, logy = TRUE)
```


```{r, fig.cap = "Reproduces Fig 4C from Grover (1990)."}
period <- 4
amp <- ((0.0002*0.25*period)/(1 - exp(-0.25*period)) - 0.0002)*2
pars$respulse <- amp
pars$rinit <- amp
pars$pulsefreq <- period
pars
```

```{r}
m4 <- sim_rescomp(pars)
plot_rescomp(m4, resource = FALSE, logy = TRUE)
```


```{r}
period <- 10
amp <- ((0.0002*0.25*period)/(1 - exp(-0.25*period)) - 0.0002)*2
pars$respulse <- amp
pars$rinit <- amp
pars$pulsefreq <- period
pars
```

```{r, fig.cap = "Reproduces Fig 4D from Grover (1990)."}
m10 <- sim_rescomp(pars)
plot_rescomp(m10, resource = FALSE, logy = TRUE)
```
